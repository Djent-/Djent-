<html>

<head>
	<title>c6b46389dcb5c1fb834199a445044440.js Analysis</title>

	<style>
	
body {
	background: rgba(0,0,0,0.1);
}

.pre {
	padding: 16px;
	background-color: #f0f2f4 !important;
	border-radius: 3px;
	margin-top: 0px;
	margin-left: 2%;
	margin-right: 2%;
	margin-bottom: 16px;
	box-sizing: border-box;
	line-height: 1.45;
	overflow: auto;
	display:flex;
	max-width:100%;
}
.inl-pre {
	padding: 4px;
	background-color: #f0f2f4 !important;
	border-radius: 3px;
	margin-top: 0px;
	margin-bottom: 2px;
	display: inline-block;
	box-sizing: border-box;
	line-height: 1.45;
}

code {
	padding: 0;
	margin: 0;
	overflow: visible;
	background-color: transparent;
	border: 0;
	font-family: "SFMono-Regular", "Consolas", "Liberation Mono", Menlo, Courier, monospace;
	font-size: 14px;
	line-height: inherit;
	word-break: normal;
	white-space: pre;
	font-weight: 400;
}

	</style>
</head>

<body>
	<p>
		<a href="/">Return</a>
	</p>
	
	<h2>c6b46389dcb5c1fb834199a445044440.js Analysis</h2>
	<h4>August 6, 2017</h4>

	<p>
		Apparently my blog for now is going to be about different ad companies that use the same techniques, and in some cases, even the same files. This post is about <span class="inl-pre"><code>c6b46389dcb5c1fb834199a445044440.js</code></span>, which is loaded from index line 54.
	</p>
	
	<div class="pre"><code><span style="color:green;">&lt;!-- PopAds.net Popunder Code for 4archive.org | 2017-08-06,1006003,0,0 --&gt;</span>
&lt;script type=&quot;text/javascript&quot; data-cfasync=&quot;false&quot;&gt; 
<span style="color:green;">/*&lt;![CDATA[/* */
/* Privet darkv. Each domain is 2h fox dead */</span>
(function(){ var t=window;t[&quot;\u005fp\u006f\u0070&quot;]=[[&quot;s\u0069\u0074e\u0049\u0064&quot;,1006003],[&quot;\x6d\x69\u006e\x42i\x64&quot;,0],[&quot;\x70\u006f\u0070\x75nd\x65\u0072\u0073\x50\x65r\x49\x50&quot;,0],[&quot;\x64\u0065\u006cay\u0042e\x74\u0077ee\u006e&quot;,0],[&quot;de\u0066\u0061\u0075lt&quot;,false],[&quot;\x64\u0065\u0066\x61\u0075\u006c\x74Pe\u0072\x44a\x79&quot;,0],[&quot;t\u006fp\x6dos\u0074\u004c\u0061\u0079\u0065r&quot;,!1]];var j=[&quot;/\x2f\x63\u0031.\x70\u006f\x70a\u0064\u0073\x2e\x6e\u0065\x74/\x70\u006fp\x2e\x6a\u0073&quot;,&quot;/\x2f\x63\u0032\u002e\u0070o\u0070ad\x73.\x6e\u0065\u0074\x2f\x70\u006f\x70\u002ej\x73&quot;,&quot;\x2f/w\u0077\x77\x2e\x6c\u006a\u0066\u0065\u0074l\x68\u006c\x65\x69\u0066\x66r\x2ebid/y\u002e\u006a\x73&quot;,&quot;//\x77\u0077\u0077\u002el\u0074\u006e\u006a\x74p\u0068\u0062\u0062v\u0069\x67\x69\x2eb\u0069\x64/\u006egl\x2e\x6a\u0073&quot;,&quot;&quot;],g=0,h,b=function(){if(&quot;&quot;==j[g])return;h=t[&quot;docu\u006dent&quot;][&quot;\u0063re\u0061t\x65\x45\x6ceme\x6e\u0074&quot;](&quot;\x73\u0063r\x69\u0070\x74&quot;);h[&quot;\u0074y\u0070\x65&quot;]=&quot;\u0074e\x78\x74\u002f\x6aava\u0073\u0063r\x69\x70t&quot;;h[&quot;a\x73\x79\u006e\u0063&quot;]=!0;var z=t[&quot;\x64\x6fc\x75\x6d\x65nt&quot;][&quot;\x67e\u0074\x45\x6c\u0065\u006d\u0065\x6e\u0074s\x42\x79\x54\x61g\u004ea\u006d\u0065&quot;](&quot;\x73c\x72\x69\x70\u0074&quot;)[0];h[&quot;s\u0072\x63&quot;]=j[g];if(g&lt;2){h[&quot;\x63\x72o\u0073\u0073\x4f\x72\x69\u0067\x69n&quot;]=&quot;\x61\x6eon\x79\u006d\u006f\x75\x73&quot;;};h[&quot;\u006f\x6ee\u0072\x72\u006f\u0072&quot;]=function(){g++;b()};z[&quot;\u0070\x61\u0072\u0065\x6etNo\u0064\x65&quot;][&quot;\u0069\u006e\x73\x65rt\u0042\x65\u0066\x6fr\u0065&quot;](h,z)};b()})(); 
<span style="color:green;">/*]]&gt;/* */ </span>
&lt;/script&gt; 
	&lt;script type='text/javascript' src=<span style="color:deeppink">'//pl3864833.puserving.com/c6/b4/63/c6b46389dcb5c1fb834199a445044440.js'</span>&gt;&lt;/script&gt;<span style="color:green;">&lt;!-- adsterra nsfw --&gt;</span>
	&lt;script data-cfasync=&quot;false&quot; src=&quot;//d1mub3aw743hsf.cloudfront.net/?abumd=616020&quot;&gt;&lt;/script&gt;<span style="color:green;">&lt;!-- admaven sfw --&gt;</span> </code></div>
	
	<p>
		When I first looked at this file, I thought I was looking at a renamed <span class="inl-pre"><code>pop.js</code></span>. It had two base64 encoded PDFs, one of which is small and insignificant, and the other is fairly large. Scrolling through the rest of the file, I found another linked PDF.
	</p>
	
	<p>
		The long embedded PDF is the <span class="inl-pre"><code>pop.js</code></span> PDF. It has the same alert script as in <span class="inl-pre"><code>pop.js</code></span>'s PDF, <span class="inl-pre"><code>app.alert('Please wait..')</code></span>, and the same metadata, indentifying <span class="inl-pre"><code>popunderjs.com</code></span> as the creator of the file.
	</p>
	
	<p>
		The linked PDF is sourced from <span class="inl-pre"><code>https://cdn15.acloudimages.com/36/template/pu1473410272.pdf</code></span>. It has the same alert script as the one found in <span class="inl-pre"><code>616020.pdf</code></span>, except they added their copyright sign to it. The PDF metadata has been stripped down a little bit, but it still has the same creator, creation and last modified date as well. If you open the document, it has the text <span class="inl-pre"><code>Copyright AdSupply 2016</code></span>.
	</p>
	
	<div class="pre"><code><span style="color:green;">/* Copyright AdSupply 2016 */</span>
app.alert("Focusing, please wait....");</code></div>

	<div class="pre"><code>14 0 &lt;&lt;/CreationDate(D:20160526135438-07'00')/Creator(Adobe Acrobat Pro DC 15.16.20039)/ModDate(D:20160603133039-07'00')/Producer(Adobe Acrobat Pro DC 15.16.20039)>></code></div>
	
	<p>
		That's a bit odd, because the HTML comments where the scripts are loaded from specify <span class="inl-pre"><code>c6b46389dcb5c1fb834199a445044440.js</code></span> is from <span class="inl-pre"><code>adsterra</code></span> and <span class="inl-pre"><code>616020.pdf</code></span> is from <span class="inl-pre"><code>admaven</code></span>. 
	</p>
	
	<p>
		It's not a huge coincidence that these scripts share resources - they're loaded all within the same few lines of the 4archive index page. It would be exciting if these ad companies were all competing with each other, using each other's innovations - I imagine it can't be easy to go to court and claim that someone is stealing your intellectual property when that IP is subverting the wishes of <s>victims</s>users.
	</p>
	
	<p>
		The only other really new thing about this script is that they don't obfuscate their variable or function names at all. Check out some of the names they use:
	</p>
	
	<ul>
		<li><span class="inl-pre"><code>system.popunder.openWindowIFrame</code></span></li>
		<li><span class="inl-pre"><code>system.popunder.openWindowOnDesktopWithOptions</code></span></li>
		<li><span class="inl-pre"><code>system.popunder.locationAssignMobile</code></span></li>
		<li><span class="inl-pre"><code>system.popunder.openWindowOnMobile</code></span></li>
		<li><span class="inl-pre"><code>system.popunder.artificialClick</code></span></li>
		<li><span class="inl-pre"><code>system.popunder.blur</code></span></li>
	</ul>
	
	<p>
		These names give a good description of the capabilities of this particular script. This is a prime script for reverse engineering, since half the work is already done.
	</p>
	
	<h3>Thanks for reading.</h3>
</body>

</html>
